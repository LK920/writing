
## 개요
헥사고날 아키텍처는 애플리케이션의 비즈니스 로직을 중심으로 외부 시스템(데이터베이스, UI, 메시지 브로커 등)과 분리하여 독립성을 높이는 설계 패턴입니다. 이 패턴은 "포트(Ports)"와 "어댑터(Adapters)"를 통해 내부 도메인 로직과 외부 환경 간의 상호작용을 정의합니다.

### 주요 개념
- **Domain/Business Logic**: 애플리케이션의 핵심 비즈니스 규칙과 로직이 포함된 중앙 영역.
- **Ports**: 도메인 로직이 외부와 통신하기 위한 인터페이스(추상화). 입력(Consumer)과 출력(Producer) 포트를 포함.
- **Adapters**: 포트에 연결되어 외부 시스템(예: UI, DB, 메시지 브로커)과 도메인 간의 변환을 담당.
- **Infrastructure**: 데이터베이스, 네트워크, 파일 시스템 등 외부 리소스를 관리.

## 계층별 상세 역할

### 1. Domain/Business Logic (도메인/비즈니스 로직)
- **역할**: 애플리케이션의 핵심 비즈니스 규칙을 구현하며, 외부 의존성에서 독립적.
- **주요 기능**:
  - 비즈니스 엔티티와 규칙 정의.
  - 포트를 통해 외부와 상호작용.
- **예시**: 주문 처리 로직, 결제 검증.

### 2. Ports (포트)
- **역할**: 도메인과 외부 시스템 간의 인터페이스로, 의존성을 추상화.
- **구분**:
  - **Input Port (입력 포트)**: 외부에서 도메인으로 요청을 전달 (예: Controller, Consumer).
  - **Output Port (출력 포트)**: 도메인이 외부로 데이터를 전송 (예: Repository, Producer).
- **주요 기능**:
  - 인터페이스 정의.
  - 어댑터가 구현할 계약 제공.
- **예시**: `OrderServicePort`, `OrderRepositoryPort`.

### 3. Adapters (어댑터)
- **역할**: 포트와 외부 시스템 간의 다리를 연결하며, 기술적 세부사항을 처리.
- **구분**:
  - **Controller Adapter**: UI(브라우저, 앱)로부터 요청을 받아 입력 포트로 전달.
  - **Consumer Adapter**: 메시지 브로커로부터 데이터를 수신.
  - **Producer Adapter**: 메시지 브로커로 데이터를 전송.
  - **DAO Adapter**: 데이터베이스와 상호작용.
- **주요 기능**:
  - 포트 인터페이스 구현.
  - 외부 시스템과의 통신(예: HTTP, JDBC).
- **예시**: `WebController`, `JDBCDao`.

### 4. Infrastructure (인프라스트럭처)
- **역할**: 외부 리소스(데이터베이스, 메시지 브로커 등)를 관리.
- **주요 기능**:
  - 데이터 저장 및 검색.
  - 메시지 큐 관리.
  - 네트워크 통신.
- **예시**: MySQL, RabbitMQ, REST API.

## 데이터 흐름
- **입력**: Browser/App → Controller Adapter → Input Port → Domain Logic.
- **출력**: Domain Logic → Output Port → DAO/Producer Adapter → DB/Message Broker.
- **이벤트**: Message Broker → Consumer Adapter → Input Port → Domain Logic.

## 실제 프로젝트 구조 예시 (Java 기반)
아래는 헥사고날 아키텍처를 적용한 간단한 프로젝트 디렉토리 구조와 코드 예시입니다.

```
src/
├── main/
│   ├── java/
│   │   ├── com.example.order/
│   │   │   ├── domain/              # 도메인 로직
│   │   │   │   ├── Order.java       # 엔티티
│   │   │   │   ├── OrderService.java # 비즈니스 로직
│   │   │   ├── ports/               # 포트
│   │   │   │   ├── input/OrderServicePort.java
│   │   │   │   ├── output/OrderRepositoryPort.java
│   │   │   ├── adapters/            # 어댑터
│   │   │   │   ├── web/             # UI 어댑터
│   │   │   │   │   ├── WebController.java
│   │   │   │   ├── db/              # DB 어댑터
│   │   │   │   │   ├── JDBCDao.java
│   │   │   │   ├── messaging/       # 메시지 어댑터
│   │   │   │   │   ├── MessageConsumer.java
│   │   │   │   │   ├── MessageProducer.java
│   │   │   └── infrastructure/      # 인프라
│   │   │       ├── config/          # 설정
│   │   │       ├── db/              # DB 설정
│   │   │       └── messaging/       # 메시지 설정
│   │   └── resources/
│   └── test/
```

### 예시 코드: OrderServicePort
```java
package com.example.order.ports.input;

public interface OrderServicePort {
    void processOrder(Long orderId);
}
```

### 예시 코드: WebController
```java
package com.example.order.adapters.web;

import com.example.order.ports.input.OrderServicePort;

public class WebController {
    private final OrderServicePort orderService;

    public WebController(OrderServicePort orderService) {
        this.orderService = orderService;
    }

    public void handleRequest(Long orderId) {
        orderService.processOrder(orderId);
    }
}
```

### 예시 코드: JDBCDao
```java
package com.example.order.adapters.db;

import com.example.order.ports.output.OrderRepositoryPort;

public class JDBCDao implements OrderRepositoryPort {
    @Override
    public void saveOrder(Long orderId) {
        // JDBC를 사용한 DB 저장 로직
    }
}
```

## 장점
- **독립성**: 도메인 로직이 외부 시스템에서 분리되어 테스트 및 유지보수가 용이.
- **유연성**: 어댑터 교체로 기술 스택 변경 가능(예: REST → gRPC).
- **확장성**: 새로운 포트와 어댑터 추가로 기능 확장 용이.

## 결론
헥사고날 아키텍처는 복잡한 애플리케이션에서 비즈니스 로직의 독립성과 재사용성을 보장하며, 외부 시스템과의 결합도를 낮춥니다. 위 예시를 기반으로 프로젝트를 설계하고, 필요에 따라 포트와 어댑터를 확장하세요.