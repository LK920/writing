# 락(Lock) vs 트랜잭션(Transaction)

## 1. 락(Lock)とは

### 정의
- **락**은 데이터베이스에서 **동시성 제어(Concurrency Control)**를 위해 사용되는 메커니즘입니다.
- 여러 사용자가 동시에 데이터를 수정하거나 접근할 때 데이터 무결성을 보장하기 위해 특정 데이터에 대한 접근을 제한합니다.
- 주로 **쓰기 작업**(Write Operation)과 관련된 충돌을 방지하는 데 초점을 맞춥니다.

### 주요 특징
- **목적**: 데이터의 일관성을 유지하기 위해 특정 리소스(예: 테이블, 행)에 대한 접근을 제어.
- **종류**:
  - **공유 락(Shared Lock)**: 읽기 작업(Read)을 위해 사용. 여러 트랜잭션이 동시에 읽을 수 있음.
  - **배타 락(Exclusive Lock)**: 쓰기 작업(Write)을 위해 사용. 다른 트랜잭션의 읽기/쓰기를 차단.
- **문제 해결**: 동시 쓰기 작업으로 인한 데이터 충돌(예: Dirty Write, Lost Update) 방지.
- **관점**: **데이터 접근 제어**에 초점. 특정 시점에서 데이터의 상태를 보호.

### 예시
- 사용자 A가 계좌 잔액을 업데이트하는 동안, 사용자 B가 같은 계좌를 수정하지 못하도록 배타 락을 걸어 보호.
- 이로 인해 A의 작업이 완료될 때까지 B는 대기.

## 2. 트랜잭션(Transaction)とは

### 정의
- **트랜잭션**은 데이터베이스에서 **논리적 작업 단위**로, 여러 작업(읽기, 쓰기 등)을 하나의 단위로 묶어 처리합니다.
- 트랜잭션은 데이터의 **일관성, 무결성, 원자성**을 보장하며, 주로 **읽기와 쓰기 작업**을 모두 포함할 수 있습니다.

### 주요 특징
- **목적**: 작업의 **원자성(Atomicity), 일관성(Consistency), 격리성(Isolation), 지속성(Durability)** (ACID)을 보장.
- **ACID 속성**:
  - **Atomicity**: 모든 작업이 완료되거나, 전혀 실행되지 않음(전부 또는 전무).
  - **Consistency**: 트랜잭션 완료 후 데이터베이스가 일관된 상태를 유지.
  - **Isolation**: 트랜잭션은 서로 독립적으로 실행됨.
  - **Durability**: 완료된 트랜잭션의 결과는 영구적으로 저장됨.
- **문제 해결**: 읽기 작업에서 발생할 수 있는 문제(예: Dirty Read, Non-repeatable Read, Phantom Read)와 쓰기 작업의 무결성 보장.
- **관점**: **작업 단위**의 실행과 데이터베이스의 논리적 상태 유지에 초점.

### 예시
- 은행 송금: 계좌 A에서 10만 원을 빼고, 계좌 B에 10만 원을 추가하는 작업.
- 이 두 작업은 하나의 트랜잭션으로 묶여, 둘 다 성공하거나 둘 다 실패해야 함.
- 트랜잭션 내에서 락을 사용하여 데이터 충돌 방지 가능.

## 3. 락과 트랜잭션의 차이점

| **구분**          | **락(Lock)**                                  | **트랜잭션(Transaction)**                     |
|--------------------|---------------------------------------------|---------------------------------------------|
| **정의**          | 데이터 접근을 제어하는 동시성 제어 메커니즘 | 논리적 작업 단위를 묶어 처리하는 단위       |
| **주요 초점**     | 쓰기 작업 간 충돌 방지                     | 작업의 논리적 완결성과 데이터 무결성 보장   |
| **사용 사례**     | 특정 데이터에 대한 동시 접근 제어           | 복잡한 작업(읽기/쓰기)을 하나의 단위로 처리 |
| **관점**          | 데이터 접근 제어                           | 작업 단위의 실행과 상태 유지                |
| **예시 문제**     | Lost Update, Dirty Write                  | Dirty Read, Non-repeatable Read, Phantom Read |
| **적용 범위**     | 특정 리소스(행, 테이블)에 적용             | 여러 작업을 하나의 논리적 단위로 묶음       |

## 4. 락과 트랜잭션의 관계
- **락은 트랜잭션의 도구**: 트랜잭션 내에서 락을 사용하여 동시성 문제를 해결합니다.
  - 예: 트랜잭션 A가 데이터를 수정할 때 배타 락을 걸어 다른 트랜잭션의 간섭을 방지.
- **격리 수준(Isolation Level)**: 트랜잭션의 격리 수준(Read Uncommitted, Read Committed 등)에 따라 락의 동작이 달라질 수 있음.
  - 낮은 격리 수준: 더 많은 동시성을 허용하지만, 읽기 관련 문제(Dirty Read 등) 발생 가능.
  - 높은 격리 수준: 데이터 무결성을 강화하지만, 성능 저하 가능.

## 5. 요약
- **락**: 쓰기 작업 중심으로 데이터 충돌을 방지하기 위한 **동시성 제어 도구**.
- **트랜잭션**: 읽기와 쓰기를 포함한 작업 단위를 관리하며, 데이터의 **논리적 무결성과 일관성**을 보장.
- **핵심 차이**: 락은 데이터 접근 제어에 초점을 맞추고, 트랜잭션은 작업의 완결성과 상태 유지에 초점을 맞춤.
- **상호작용**: 트랜잭션은 락을 활용하여 동시성 문제를 해결하며, 락은 트랜잭션의 격리성을 구현하는 데 사용됨.