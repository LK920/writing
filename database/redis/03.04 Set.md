---
aliases:
  - 레디스_기본_개념
  - 레디스_set
tags:
  - 레디스
  - redis
  - 레디스기본개념
  - 레디스자료구조
  - set
---
# Redis Set 자료구조

## 기본 개요

**정렬되지 않은 유일한 문자열의 모음**입니다. 순서가 없고, 중복된 원소를 허용하지 않습니다.

- **특징**: 순서 없음, 중복 불가능, 유일성 보장
- **핵심 기능**: 집합 연산 (합집합, 교집합, 차집합)
- **활용**: 태그, 팔로우 관계, 추천 시스템, 유일값 추적 등

---

## 데이터 구조 예시

```
SADD hobby:john "reading" "gaming" "cooking"
SADD hobby:jane "gaming" "swimming" "cooking"

Redis 메모리에 저장되는 구조:
{
  "hobby:john": {"reading", "gaming", "cooking"},
  "hobby:jane": {"gaming", "swimming", "cooking"}
}
```

---

## 시간 복잡도

|작업|시간복잡도|설명|
|---|---|---|
|SADD / SREM|**O(1)**|매우 빠름|
|SMEMBERS|**O(N)**|원소 개수만큼 소요|
|SINTER / SUNION / SDIFF|**O(N+M)**|집합 크기에 따라 소요|
|SPOP|**O(1)**|빠른 랜덤 추출|

---

## 핵심 커맨드

### 저장 및 조회

```
SADD key member [member...]          // 1개 이상의 원소 저장 (중복 자동 제거)
SMEMBERS key                         // 모든 원소 조회 (순서 무관)
SCARD key                            // 원소 개수 조회
SISMEMBER key member                 // 특정 원소 존재 여부 확인
```

### 제거

```
SREM key member [member...]          // 특정 원소 삭제
SPOP key [count]                     // 랜덤 원소 조회 + 삭제
```

### 집합 연산 (핵심!)

```
SUNION key [key...]                  // 합집합: 모든 원소 모음
SINTER key [key...]                  // 교집합: 공통 원소만
SDIFF key [key...]                   // 차집합: 첫 번째 Set에서만 있는 원소
```

**집합 연산 저장하기** (결과를 새로운 Set으로 저장)

```
SUNIONSTORE dest_key key1 key2       // 합집합 결과 저장
SINTERSTORE dest_key key1 key2       // 교집합 결과 저장
SDIFFSTORE dest_key key1 key2        // 차집합 결과 저장
```

---

## 실제 사용 예시

### 1️⃣ 공통 관심사 찾기 (교집합)

```
SADD hobby:john "reading" "gaming" "cooking"
SADD hobby:jane "gaming" "swimming" "cooking"

SINTER hobby:john hobby:jane
// 결과: {"gaming", "cooking"}  → John과 Jane의 공통 취미
```

**실무 활용**: 추천 시스템 (공통 관심사가 있는 사용자들에게 서로 추천)

### 2️⃣ 좋아요 유일성 보장 (중복 방지)

```
SADD post:123:likes user:john
SADD post:123:likes user:jane
SADD post:123:likes user:john    // 이미 있으면 추가 안됨

SCARD post:123:likes             // 좋아요 개수: 2
```

**vs List로 하면?** LPUSH로 계속 추가되어 같은 사용자가 여러 번 나타날 수 있음.

### 3️⃣ 팔로우 관계 (차집합)

```
SADD user:john:following user:alice user:bob user:charlie
SADD user:bob:following user:alice user:charlie user:david

SDIFF user:john:following user:bob:following
// 결과: {user:bob}  → John이 팔로우하지만 Bob은 안 하는 사람
```

### 4️⃣ 팔로워 중 공통 팔로워 (교집합)

```
SADD user:alice:followers user:john user:bob user:charlie
SADD user:bob:followers user:john user:charlie user:david

SINTER user:alice:followers user:bob:followers
// 결과: {user:john, user:charlie}  → Alice와 Bob의 공통 팔로워
```

---

## Set vs List vs Hash 비교

|측면|Set|List|Hash|
|---|---|---|---|
|순서|❌ 없음|✅ 있음|❌ 없음|
|중복|❌ 불가능|✅ 가능|❌ 불가능 (필드)|
|주요 용도|집합 연산, 유일값|순서 중요, Queue|객체 속성|
|추천 상황|태그, 팔로우|로그, 작업큐|사용자 정보|

---

## 성능 최적화 팁

### ✅ 하면 좋은 것

- SADD / SREM / SPOP: O(1)로 매우 빠름
- 집합 연산으로 복잡한 쿼리 대체 (DB 부하 감소)
- SINTERSTORE로 결과 저장해두기 (캐싱 효과)

### ⚠️ 피해야 할 것

- 매우 큰 Set에 SMEMBERS: 메모리/CPU 부하
- 복잡한 집합 연산을 매번 실행: STORE로 미리 저장하기
- Set을 소팅이 필요한 상황에 사용: Sorted Set 고려

---

## 실무 활용 예상

|상황|커맨드|
|---|---|
|게시물 좋아요|SADD post:123:likes user:john|
|팔로우 관계|SADD user:john:following user:alice|
|공통 관심사 추천|SINTER user:john:interests user:alice:interests|
|온라인 사용자 추적|SADD online:users user:john|
|이메일 구독자|SADD subscribers:newsletter user:john user:alice|
