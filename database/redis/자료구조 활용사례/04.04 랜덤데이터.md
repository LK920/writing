---
aliases:
  - 랜덤 값 추출
tags:
  - 랜덤
  - hash
  - sortedset
  - set
---
## 랜덤 데이터 추출

### 관계형 데이터베이스의 랜덤 추출

RDBMS에서는 `ORDER BY RAND()`를 사용하여 랜덤 추출을 수행합니다.

**처리 과정:**
1. 조건 절에서 모든 행을 읽음
2. 임시 테이블 생성
3. 랜덤하게 정렬
4. LIMIT에 해당하는 만큼 추출

**문제점:**
- 부하가 많이 발생
- 1만 건 이상일 경우 심각한 성능 이슈 발생

### Redis의 RANDOM 커맨드

Redis는 각 자료구조별로 랜덤 추출을 위한 전용 커맨드를 제공합니다.

#### 주요 커맨드
- `RANDOMKEY`: 저장된 전체 키 중 하나를 무작위로 반환
- `HRANDFIELD`: Hash에서 랜덤 필드 추출
- `SRANDMEMBER`: Set에서 랜덤 멤버 추출
- `ZRANDMEMBER`: Sorted Set에서 랜덤 멤버 추출

#### 옵션

**count 옵션**: 원하는 개수만큼 추출
```redis
# 양수: 중복 허용 안 함 (유니크한 값들)
SRANDMEMBER myset 3

# 음수: 중복 허용 (같은 값이 여러 번 나올 수 있음)
SRANDMEMBER myset -3
```

**withvalues/withscores 옵션**: 값이나 점수도 함께 반환
```redis
# Hash의 경우 필드와 값을 함께 반환
HRANDFIELD myhash 2 WITHVALUES

# Sorted Set의 경우 멤버와 점수를 함께 반환
ZRANDMEMBER myzset 2 WITHSCORES
```